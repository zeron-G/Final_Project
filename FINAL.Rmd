---
title: "finalproject"
date: "2023-07-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

#following code use R and the data from code_1 to generate plot
```{r}
library(fpp2)
library(rmarkdown)
library(itsmr)
library(readr)
```

```{r}
DJIA<-read_csv("data/DJIA.csv")
SS_1<-read_csv("data/000001ss.csv")
NASDAQ<-read_csv("data/NASDAQ.csv")
SZ399001<-read_csv("data/399001sz.csv")
```
```{r}
DJIA.tsd<-ts(DJIA[,"Close"]-DJIA[,"Open"])
```

```{r}
DJIA.ts <- ts(DJIA[,"Close"])
ss.ts<-ts(SS_1[,"Close"])
na.ts<-ts(NASDAQ[,"Close"])
sz.ts<-ts(SZ399001[,"Close"])

DJIA.tsd<-ts(DJIA[,"Close"]-DJIA[,"Open"])
DJIA.return<-ts((DJIA[,"Close"]-DJIA[,"Open"])/DJIA[,"Open"])


ss.tsd<-ts(SS_1[,"Close"]-SS_1[,"Open"])
ss.return<-ts((SS_1[,"Close"]-SS_1[,"Open"])/SS_1[,"Open"])
na.tsd<-ts(NASDAQ[,"Close"]-NASDAQ[,"Open"])
na.return<-ts((NASDAQ[,"Close"]-NASDAQ[,"Open"])/NASDAQ[,"Open"])
sz.tsd<-ts(SZ399001[,"Close"]-SZ399001[,"Open"])
sz.return<-ts((SZ399001[,"Close"]-SZ399001[,"Open"])/SZ399001[,"Open"])


autoplot(DJIA.ts)
autoplot(DJIA.tsd)
autoplot(DJIA.return)
test(DJIA.ts)
test(DJIA.tsd)
test(DJIA.return)
autoplot(ss.ts)
autoplot(ss.tsd)
autoplot(ss.return)
test(ss.ts)
test(ss.tsd)
test(ss.return)
autoplot(na.ts)
autoplot(na.tsd)
autoplot(na.return)
test(na.ts)
test(na.tsd)
test(na.return)
autoplot(sz.ts)
autoplot(sz.tsd)
autoplot(sz.return)
test(sz.ts)
test(sz.tsd)
test(sz.return)
```

```{r}
na.diff<-diff(na.ts)
autoplot(na.diff)
```

```{r}
na.ts.ses<-ses(na.ts, h=100)
na.ts.holt<-holt(na.ts, h=100)
na.ts.sesd<-ses(na.ts,damped=TRUE, h=100)
na.ts.holtd<-holt(na.ts,damped=TRUE, h=100)
autoplot(na.ts.ses)
autoplot(na.ts.holt)
autoplot(na.ts.sesd)
autoplot(na.ts.holtd,include=200)
summary(na.ts.ses)
summary(na.ts.holt)
summary(na.ts.sesd)
summary(na.ts.holtd)
res.holtd<-residuals(na.ts.holtd)
test(res.holtd)
```
```{r}
na.arima<-auto.arima(na.ts)
autoplot(na.arima)
future <- forecast::forecast(na.arima, h=12)
autoplot(future,include=100)
```

```{r}
na.log<-log(na.ts)
autoplot(ets(na.log))
checkresiduals(ets(na.log))
na.log2<-window(na.log,start=5000)
plot(na.log)
checkresiduals(ets(na.log2))
```

```{r}
checkresiduals(ss.tsd)
```
```{r}
ets(ss.ts)
autoplot(forecast::forecast(ets(ss.ts)))
str(ss.ts)
head(ss.ts)

ss.ts.ses <- ses(ss.ts, h = 400)
autoplot(ss.ts.ses) +
  autolayer(ss.ts.ses$fitted)
ss.ts.ses$model
```
```{r}
ss.ts.meanf <- meanf(ss.ts, h=20)
autoplot(ss.ts.meanf)
# Plot last 100 values of series with forecasts
autoplot(ss.ts.meanf, include=100)
ss.ts.naive <- naive(ss.ts, h=20)
autoplot(ss.ts.naive)
# Plot last 100 values of series with forecasts
autoplot(ss.ts.naive, include=100)
ss.ts.snaive <- snaive(ss.ts, h=20)
autoplot(ss.ts.snaive)
# Plot last 100 values of series with forecasts
autoplot(ss.ts.snaive, include=100)
ss.ts.rwf <- rwf(ss.ts, h=20)
autoplot(ss.ts.rwf)
# Plot last 100 values of series with forecasts
autoplot(ss.ts.rwf, include=100)
```
```{r}
myts <- ts(NASDAQ[,"Close"], frequency=12, start=c(1995-02-21))
myts.train <- window(myts, end=c(2010-02-21))
myts.test <- window(myts, start=2010-2-21)

autoplot(myts) +
  autolayer(myts.train, series="Training") +
  autolayer(myts.test, series="Test")
fc <- snaive(myts.train)
autoplot(fc,h=100)
checkresiduals(fc)
```



