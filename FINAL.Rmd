---
title: "finalproject"
date: "2023-07-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

#following code use R and the data from code_1 to generate plot
```{r}
library(fpp2)
library(rmarkdown)
library(itsmr)
library(readr)
```

```{r}
ss<-read_csv("data/000001ss.csv")
na<-read_csv("data/NASDAQ.csv")
```

```{r}
ss.ts<-ts(ss[,"Close"])
na.ts<-ts(na[,"Close"])
na.log<-ts(log(na[,"Close"]))
ss.log<-ts(log(ss[,"Close"]))
na.diff<-diff(na.ts)
ss.diff<-diff(ss.ts)
na.logd<-diff(na.log)
ss.diff<-diff(ss.log)
```
```{r}
test(na.ts)
test(na.diff)
test(na.log)
test(na.logd)
```


```{r}
myts <- ts(na.log, frequency=30)
myts.train <- window(myts,end=150)
myts.test <- window(myts,start=150)

autoplot(myts) +
  autolayer(myts.train, series="Training") +
  autolayer(myts.test, series="Test")
fc <- auto.arima(myts.train)

future <- forecast::forecast(fc, h=50)

autoplot(future,h=100,include = 100)

checkresiduals(fc)
```
```{r}
accuracy(fc,myts.test)
```


```{r}
na.ts.ses<-ses(na.ts, h=100)
na.ts.holt<-holt(na.ts, h=100)
na.ts.sesd<-ses(na.ts,damped=TRUE, h=100)
na.ts.holtd<-holt(na.ts,damped=TRUE, h=100)
autoplot(na.ts.ses)
autoplot(na.ts.holt)
autoplot(na.ts.sesd)
autoplot(na.ts.holtd,include=200)
summary(na.ts.ses)
summary(na.ts.holt)
summary(na.ts.sesd)
summary(na.ts.holtd)
res.holtd<-residuals(na.ts.holtd)
test(res.holtd)
```
```{r}
na.ts.log<-log(na.ts)
autoplot(na.ts.log)
test(na.ts.log)
na.logd<-diff(na.ts.log)
autoplot(na.logd)
test(na.logd)
```

```{r}
na.arima<-auto.arima(na.ts.log)
autoplot(na.arima)
future <- forecast::forecast(na.arima, h=12)
autoplot(future,include=100)
```

```{r}
na.log<-log(na.ts)
autoplot(ets(na.log))
checkresiduals(ets(na.log))
na.log2<-window(na.log,start=5000)
plot(na.log)
checkresiduals(ets(na.log2))
```

```{r}
checkresiduals(ss.tsd)
```
```{r}
ets(ss.ts)
autoplot(forecast::forecast(ets(ss.ts)))
str(ss.ts)
head(ss.ts)

ss.ts.ses <- ses(ss.ts, h = 400)
autoplot(ss.ts.ses) +
  autolayer(ss.ts.ses$fitted)
ss.ts.ses$model
```




